From 119f9309221107b260fb15e6209e41c3492270ae Mon Sep 17 00:00:00 2001
From: Conor Dooley <conor.dooley@microchip.com>
Date: Fri, 2 Jul 2021 15:04:10 +0100
Subject: [PATCH 35/93] riscv: icicle: add system services driver support

---
 .../boot/dts/microchip/microchip-mpfs.dtsi    | 27 +++++++++++++++++++
 arch/riscv/configs/icicle_kit_defconfig       |  5 ++++
 2 files changed, 32 insertions(+)

diff --git a/arch/riscv/boot/dts/microchip/microchip-mpfs.dtsi b/arch/riscv/boot/dts/microchip/microchip-mpfs.dtsi
index 43033f6a2805..b060cabdac79 100644
--- a/arch/riscv/boot/dts/microchip/microchip-mpfs.dtsi
+++ b/arch/riscv/boot/dts/microchip/microchip-mpfs.dtsi
@@ -376,6 +376,33 @@ hwrandom: hwrandom {
 			#size-cells = <1>;
 			syscontroller = <&syscontroller>;
 		};
+		serialnum: serialnum {
+			compatible = "microchip,polarfire-soc-serial-number";
+			#address-cells = <1>;
+			#size-cells = <1>;
+			syscontroller = <&syscontroller>;
+		};
+
+		fpgadigest: fpgadigest {
+			compatible = "microchip,polarfire-soc-digest";
+			#address-cells = <1>;
+			#size-cells = <1>;
+			syscontroller = <&syscontroller>;
+		};
+
+		devicecert: cert {
+			compatible = "microchip,polarfire-soc-device-cert";
+			#address-cells = <1>;
+			#size-cells = <1>;
+			syscontroller = <&syscontroller>;
+		};
+
+		signature: signature {
+			compatible = "microchip,polarfire-soc-signature";
+			#address-cells = <1>;
+			#size-cells = <1>;
+			syscontroller = <&syscontroller>;
+		};
 
 		rtc: rtc@20124000 {
 			#address-cells = <1>;
diff --git a/arch/riscv/configs/icicle_kit_defconfig b/arch/riscv/configs/icicle_kit_defconfig
index 64d2813affd0..6c5f52504cac 100644
--- a/arch/riscv/configs/icicle_kit_defconfig
+++ b/arch/riscv/configs/icicle_kit_defconfig
@@ -170,3 +170,8 @@ CONFIG_BLK_DEV_NVME=y
 
 CONFIG_PWM=y
 CONFIG_PWM_MICROCHIP_CORE=y
+
+CONFIG_POLARFIRE_SOC_SERIAL_NUMBER=y
+CONFIG_POLARFIRE_SOC_FPGA_DIGEST=y
+CONFIG_POLARFIRE_SOC_SIGNATURE=y
+CONFIG_POLARFIRE_SOC_FPGA_CERT=y
-- 
2.30.2

